{% extends 'core/base.html' %} {% load static %}

<style>
  

  @media (min-width: 992px) { /* Pantallas grandes (lg y superiores) */
    .container-welcome > div {
      margin-left: 2rem !important; /* Ajusta la distancia al margen izquierdo */
    }
  }

</style>

{% block content %}



{% comment %} <div class="container-fluid ficha-medica-container" style="margin: 0; padding: 0;">
      <!-- Estado del Apto Médico con Bienvenida -->
      {% if ficha_medica.estado == "APROBADA" %}
      <div class="alert alert-success ficha-medica aprobada d-flex flex-column flex-md-row justify-content-between align-items-center text-center text-md-start" style="margin: 0; padding: 10px;" role="alert">
        <p class="mb-2 mb-md-0">
          <strong>Estado del Apto Médico:</strong> {{ ficha_medica.estado }}
          <strong>- Fecha de Caducidad:</strong> {{ ficha_medica.fecha_caducidad }}
        </p>
        <p class="mb-0 text-md-end fs-4">
          <strong>Bienvenido {{ profile.nombre }} {{ profile.apellido }}</strong>
        </p>
      </div>
      {% elif ficha_medica.estado == "EN PROCESO" %}
      <div class="alert alert-warning ficha-medica en-proceso d-flex flex-column flex-md-row justify-content-between align-items-center text-center text-md-start" style="margin: 0; padding: 10px;" role="alert">
        <p class="mb-2 mb-md-0">
          <strong>Estado del Apto Médico:</strong> {{ ficha_medica.estado }}
        </p>
        <p class="mb-0 text-md-end fs-4">
          <strong>Bienvenido {{ profile.nombre }} {{ profile.apellido }}</strong>
        </p>
      </div>
      {% elif ficha_medica.estado == "RECHAZADA" %}
      <div class="alert alert-danger ficha-medica rechazada d-flex flex-column flex-md-row justify-content-between align-items-center text-center text-md-start" style="margin: 0; padding: 10px;" role="alert">
        <p class="mb-2 mb-md-0">
          <strong>Estado del Apto Médico:</strong> {{ ficha_medica.estado }}
        </p>
        <p class="mb-0 text-md-end fs-4">
          <strong>Bienvenido {{ profile.nombre }} {{ profile.apellido }}</strong>
        </p>
      </div>
      {% else %}
      <div class="alert ficha-medica no-aprobada d-flex flex-column flex-md-row justify-content-between align-items-center text-center text-md-start" style="margin: 0; padding: 10px; background-color: #f8f9fa; color: #343a40; border: 1px solid #ddd;" role="alert">
        <p class="mb-2 mb-md-0">
          <strong>No tienes aptos médicos aprobados.</strong>
        </p>
        <p class="mb-0 text-md-end fs-4">
          <strong>Bienvenido {{ profile.nombre }} {{ profile.apellido }}</strong>
        </p>
      </div>
      {% endif %}
</div> {% endcomment %}





<div class="row" style="margin: 0; padding: 0;">
    <div class="container-fluid ficha-medica-container" style="margin: 0; padding: 0;">
      <nav class="navbar navbar-expand-lg py-3" style="background-color: #00c4f6; color: white; margin: 0; padding: 0;">
        <div class="container-fluid">
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#menuItems"
            aria-controls="menuItems"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="menuItems">
            <ul class="navbar-nav w-100">
              <!-- Consultar Apto -->
              <li class="nav-item">
                <a class="nav-link fs-5" href="#" id="consultarApto" style="color: white; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);">
                  <i class="bi bi-file-medical"></i> Consultar Apto
                </a>
              </li>
      
              <!-- Datos Médicos con submenú -->
              <li class="nav-item dropdown" style="position: relative;">
                <a
                  class="nav-link dropdown-toggle fs-5"
                  href="#"
                  id="datomedico"
                  style="color: white; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);"
                >
                  <i class="bi bi-journal-text"></i> Datos Médicos
                </a>
                <ul id="submenuDatosMedicos" style="
                  display: none;
                  position: absolute;
                  background-color: #00c4f6;
                  color: white;
                  list-style: none;
                  padding: 10px;
                  border-radius: 5px;
                  box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
                  z-index: 1000;
                ">
                  <li style="margin-bottom: 5px;">
                    <a href="{% url 'registroMedico:ver_antecedente' jugador.id %}" style="color: white; text-decoration: none; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);">
                      Antecedentes
                    </a>
                  </li>
                  <li>
                    <a href="{% url 'registroMedico:consentimiento' ficha_medica.idfichaMedica %}" style="color: white; text-decoration: none; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);">
                      Consentimientos
                    </a>
                  </li>
                </ul>
              </li>
      
              <!-- Estudios con submenú -->
              <li class="nav-item dropdown" style="position: relative;">
                <a
                  class="nav-link dropdown-toggle fs-5"
                  href="#"
                  id="estudios"
                  style="color: white; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);"
                >
                  <i class="bi bi-book"></i> Estudios
                </a>
                <ul id="submenuEstudios" style="
                  display: none;
                  position: absolute;
                  background-color: #00c4f6;
                  color: white;
                  list-style: none;
                  padding: 10px;
                  border-radius: 5px;
                  box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
                  z-index: 1000;
                ">
                  <li style="margin-bottom: 5px;">
                    <a href="{% url 'registroMedico:cargar_estudio' ficha_medica.idfichaMedica %}" style="color: white; text-decoration: none; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);">
                      Cargar Estudios
                    </a>
                  </li>
                  <li>
                    <a href="{% url 'registroMedico:ver_estudios' ficha_medica.idfichaMedica %}" style="color: white; text-decoration: none; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);">
                      Ver Estudios
                    </a>
                  </li>
                </ul>
              </li>
      
              <!-- Datos Personales -->
              <li class="nav-item">
                <a class="nav-link fs-5" href="#" id="datospersonales" style="color: white; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);">
                  <i class="bi bi-person"></i> Datos Personales
                </a>
              </li>
      
              <!-- Ver Torneo -->
              <li class="nav-item">
                <a class="nav-link fs-5" href="#" id="vertorneo" style="color: white; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);">
                  <i class="bi bi-trophy"></i> Ver Torneo
                </a>
              </li>

               <!-- Notificaciones -->
              <li class="nav-item dropdown" style="position: relative;">
                <a
                  class="nav-link dropdown-toggle fs-5"
                  href="#"
                  id="notificaciones"
                  style="color: white; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);"
                >
                  <i class="bi bi-bell"></i> Notificaciones
                </a>
                <ul id="submenuNotificaciones" style="
                  display: none;
                  position: absolute;
                  background-color: #00c4f6;
                  color: white;
                  list-style: none;
                  padding: 10px;
                  border-radius: 5px;
                  box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
                  z-index: 1000;
                  max-width: 500px;
                ">
                  <li>
                    <div class="alert alert-success ficha-medica aprobada" style="margin: 0; padding: 10px;">
                      <strong>Estado del Apto Médico:</strong> {{ ficha_medica.estado }}
                      <strong>- Fecha de Caducidad:</strong> {{ ficha_medica.fecha_caducidad }}
                    </div>
                  </li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
      </nav>
      
      
      

        <!-- Main content with background image -->
        <main class="px-3" style="position: relative; min-height: 100vh; width: 100%; margin: 0; padding: 0;">
          <style>
            main::before {
              content: '';
              position: absolute;
              top: 0;
              left: 0;
              width: 100%;
              height: 100%;
              background: url('{% static "core/img/medico_home.jpg" %}') no-repeat center center;
              background-size: cover;
              opacity: 0.4; /* Controla la transparencia de la imagen */
              z-index: -1; /* Coloca la imagen detrás del contenido */
            }
          </style>
          <div style="position: relative; z-index: 1;">
               
                  <!-- Mensaje de Bienvenida  -->
                  <div class="container-welcome d-flex justify-content-start" id="welcome" style="margin-top: 0px;">
                    <div class="p-4 bg-light rounded shadow" style="max-width: 600px; margin-left: 0;margin-top: 80px;">
                      <h1 class="text-primary mb-3">¡Bienvenido a tu espacio de gestión médica!</h1>
                      <p class="text-secondary fs-5">
                        En esta sección podrás gestionar todos tus datos médicos de manera sencilla y segura.
                        Podrás consultar el estado de tu apto médico, cargar nuevos estudios, revisar tus antecedentes
                        y dar los consentimientos necesarios para participar en los torneos.
                      </p>
                      <p class="text-secondary fs-5">
                        Utiliza el menú de navegación para explorar las distintas opciones.
                        Estamos aquí para ayudarte a mantener tu salud al día y asegurarte de que estés listo para dar lo mejor en cada competencia.
                      </p>

                      <!-- Lógica para mostrar la alerta -->
                      {% if not ficha_medica.consentimiento_persona %}
                      <div class="mt-4 d-flex justify-content-between align-items-center alert" 
                          style="background-color: #e3f7fc; color: #084c61; border: 1px solid #c8e6ef; padding: 20px; border-radius: 8px;">
                        <!-- Texto a la izquierda -->
                        <span class="fs-5" style="font-family: 'Nunito Sans', sans-serif;">
                          {% if ficha_medica.antecedenteenfermedades %}
                          <strong>Recuerda:</strong> Carga tu consentimiento.
                          {% else %}
                          <strong>Recuerda:</strong> Carga tus antecedentes de enfermedades.
                          {% endif %}
                        </span>

                        <!-- Botón a la derecha -->
                        <a href="{% url 'registroMedico:consentimiento' ficha_medica.idfichaMedica %}" 
                          class="btn btn-primary btn-lg" 
                          style="font-family: 'Nunito Sans', sans-serif; font-weight: 600;">Cargar</a>
                      </div>
                      {% endif %}

                    </div>
                  </div>




                  



                <!-- Sección para mostrar el torneo seleccionado -->
                {% for categoria_equipo in jugador_info.categorias_equipo %}
                <div class="container d-none" id="torneoSeleccionado">
                  <h1 class="text-center mb-5" >Torneo Seleccionado</h1>
                  <!-- Añadido margin-top al h1 -->
                  <div class="card shadow-sm">
                    <div class="card-body text-center">
                      <h2 id="nombreTorneo" class="mb-4">
                        {{ categoria_equipo.torneo }}
                      </h2>
                      <!-- Nombre del torneo -->
                      <img
                        id="logoTorneo"
                        src="{% static 'core/img/ucfal.png' %}"
                        alt="Logo del torneo"
                        style="max-width: 150px"
                      />
                      <!-- Logo del torneo -->
                      {% endfor %}
                      <!-- Mapa de Google Maps embebido -->
                      <div class="mt-4">
                        <h5>Ubicación del Torneo</h5>
                        <div class="responsive-map" style="max-width: 100%; height: 500px; margin: auto;">
                          <!-- Ajusta la altura del mapa -->
                          <iframe
                            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d4820.030071378765!2d-64.19140032407297!3d-31.323751378199383!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x94329a2946526775%3A0x990a4ccfbc13a275!2sUni%C3%B3n%20Cordobesa%20de%20F%C3%BAtbol%20Amateur!5e0!3m2!1ses!2sar!4v1729720527705!5m2!1ses!2sar"
                            allowfullscreen=""
                            loading="lazy"
                            referrerpolicy="no-referrer-when-downgrade"
                            style="width: 100%; height: 100%; border: 0;">
                          </iframe>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                
               <!-- Tabla de Apto Médico -->
                    <div class="table-responsive" id="aptoTable" style="margin-top: 40px;margin-bottom: 40px">
                      <h1 class="text-left" style="margin-bottom: 40px">Lista de Torneos Inscriptos</h1>
                      <table class="table table-striped table-bordered d-none d-md-table">
                        <thead>
                          <tr class="text-center">
                            <th>Torneo</th>
                            <th>Categoría</th>
                            <th>Equipo</th>
                            <th>Consentimiento</th>
                            <th>Antecedentes</th>
                            <th>Apto Médico</th>
                          </tr>
                        </thead>
                        <tbody>
                          {% for categoria_equipo in jugador_info.categorias_equipo %}
                          <tr class="text-center">
                            <td>{{ categoria_equipo.torneo }}</td>
                            <td>{{ categoria_equipo.nombre_categoria }}</td>
                            <td>{{ categoria_equipo.nombre_equipo }}</td>
                            <td>
                              {% if ficha_medica.consentimiento_persona %}
                              Sí
                              {% else %}
                              No
                              {% endif %}
                            </td>
                            <td>
                              <div class="text-center">
                                {% if ficha_medica.antecedenteenfermedades %}
                                <a href="{% url 'registroMedico:ver_antecedente' jugador.id %}" class="btn btn-success">Ver</a>
                                {% else %}
                                <a href="{% url 'registroMedico:cargar_antecedente' jugador.id %}" class="btn btn-warning">Cargar</a>
                                {% endif %}
                              </div>
                            </td>
                            <td>
                              <div class="text-center">
                                {% if ficha_medica.estado == "APROBADA" %}
                                <a href="{% url 'ficha_medica' jugador.id %}" class="btn btn-success">Ver</a>
                                {% else %}
                                <span class="text-danger">{{ ficha_medica.estado }}</span>
                                {% endif %}
                              </div>
                            </td>
                          </tr>
                          {% endfor %}
                        </tbody>
                      </table>

                      <!-- Versión responsiva para dispositivos pequeños -->
                          <div class="d-block d-md-none">
                            
                            {% for categoria_equipo in jugador_info.categorias_equipo %}
                            <div class="card mb-3">
                              <div class="card-body">
                                <table class="table table-borderless">
                                  <tbody>
                                    <tr>
                                      <th scope="row">Torneo:</th>
                                      <td>{{ categoria_equipo.torneo }}</td>
                                    </tr>
                                    <tr>
                                      <th scope="row">Categoría:</th>
                                      <td>{{ categoria_equipo.nombre_categoria }}</td>
                                    </tr>
                                    <tr>
                                      <th scope="row">Equipo:</th>
                                      <td>{{ categoria_equipo.nombre_equipo }}</td>
                                    </tr>
                                    <tr>
                                      <th scope="row">Consentimiento:</th>
                                      <td>
                                        {% if ficha_medica.consentimiento_persona %}
                                        Sí
                                        {% else %}
                                        No
                                        {% endif %}
                                      </td>
                                    </tr>
                                    <tr>
                                      <th scope="row">Antecedentes:</th>
                                      <td>
                                        {% if ficha_medica.antecedenteenfermedades %}
                                        <a href="{% url 'registroMedico:ver_antecedente' jugador.id %}" class="btn btn-success btn-sm">Ver</a>
                                        {% else %}
                                        <a href="{% url 'registroMedico:cargar_antecedente' jugador.id %}" class="btn btn-warning btn-sm">Cargar</a>
                                        {% endif %}
                                      </td>
                                    </tr>
                                    <tr>
                                      <th scope="row">Apto Médico:</th>
                                      <td>
                                        {% if ficha_medica.estado == "APROBADA" %}
                                        <a href="{% url 'ficha_medica' jugador.id %}" class="btn btn-success btn-sm">Ver</a>
                                        {% else %}
                                        <span class="text-danger">{{ ficha_medica.estado }}</span>
                                        {% endif %}
                                      </td>
                                    </tr>
                                  </tbody>
                                </table>
                              </div>
                            </div>
                            {% endfor %}
                          </div>

                    </div>

                <!-- Datos Personales -->
                <div class="container  d-none" id="datosPersonales">
                  <h1 class="text-center mb-4">Datos Personales</h1>
                  <div class="card shadow-sm">
                    <div class="card-body">
                      <table class="table table-striped table-bordered">
                        <tbody>
                          <tr>
                            <th>Nombre</th>
                            <td>{{ profile.nombre }}</td>
                          </tr>
                          <tr>
                            <th>Apellido</th>
                            <td>{{ profile.apellido }}</td>
                          </tr>
                          <tr>
                            <th>DNI</th>
                            <td>{{ profile.dni }}</td>
                          </tr>
                          <tr>
                            <th>Fecha de Nacimiento</th>
                            <td>{{ profile.fecha_nacimiento }}</td>
                          </tr>
                          <tr>
                            <th>Email</th>
                            <td>{{ profile.email }}</td>
                          </tr>
                          <tr>
                            <th>Teléfono</th>
                            <td>{{ persona.telefono }}</td>
                          </tr>
                          <tr>
                            <th>Teléfono Alternativo</th>
                            <td>{{ persona.telefono_alternativo }}</td>
                          </tr>
                          <tr>
                            <th>Dirección</th>
                            <td>{{ persona.direccion }}</td>
                          </tr>
                          <tr>
                            <th>Obra Social</th>
                            <td>{{ persona.jugador.cobertura_medica }}</td>
                          </tr>
                          <tr>
                            <th>Numero de Afiliado</th>
                            <td>{{ persona.jugador.numero_afiliado }}</td>
                          </tr>
                        </tbody>
                      </table>
                      <div class="text-center mt-4">
                        <a
                          href="{% url 'modificar_perfil' %}"
                          class="btn btn-success btn-lg"
                          >Modificar</a
                        >
                      </div>
                    </div>
                  </div>
                </div>
   



          </div>
        </main>


    </div>
</div>
<!-- Bootstrap CSS -->

<!-- Bootstrap JS (con Popper.js incluido) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    // Función para ocultar todas las secciones excepto welcome
    function hideAllSectionsExceptWelcome() {
      const sections = ["aptoTable", "datosPersonales", "torneoSeleccionado"];
      sections.forEach((sectionId) => {
        const section = document.getElementById(sectionId);
        if (section) {
          section.classList.add("d-none"); // Ocultar sección
        }
      });
    }
  
    // Función para alternar la visibilidad de los submenús
    function toggleSubmenu(linkId, submenuId) {
      const link = document.getElementById(linkId);
      const submenu = document.getElementById(submenuId);
  
      if (link && submenu) {
        link.addEventListener("click", function (event) {
          event.preventDefault();
          submenu.style.display = submenu.style.display === "block" ? "none" : "block";
        });
  
        // Cerrar el submenú si se hace clic fuera de él
        document.addEventListener("click", function (event) {
          if (!link.contains(event.target) && !submenu.contains(event.target)) {
            submenu.style.display = "none";
          }
        });
      }
    }
  
    // Inicializar el comportamiento del menú principal
    function initializeMenu() {
      hideAllSectionsExceptWelcome(); // Ocultar todas las secciones excepto welcome al cargar
  
      // Mostrar la sección de bienvenida al cargar la página
      const welcomeSection = document.getElementById("welcome");
      if (welcomeSection) {
        welcomeSection.classList.remove("d-none");
      }
  
      // Manejar clics en las opciones del menú principal
      const menuLinks = document.querySelectorAll(".navbar-nav .nav-link");
      menuLinks.forEach((link) => {
        link.addEventListener("click", function (event) {
          event.preventDefault();
  
          // Ocultar todas las secciones excepto welcome si es notificaciones
          if (this.getAttribute("id") === "notificaciones") {
            hideAllSectionsExceptWelcome();
            document.getElementById("welcome").classList.remove("d-none");
          } else {
            hideAllSectionsExceptWelcome();
            document.getElementById("welcome").classList.add("d-none");
          }
  
          // Mostrar la sección correspondiente según el ID del enlace
          const targetId = this.getAttribute("id");
          if (targetId === "consultarApto") {
            document.getElementById("aptoTable").classList.remove("d-none");
          } else if (targetId === "datospersonales") {
            document.getElementById("datosPersonales").classList.remove("d-none");
          } else if (targetId === "vertorneo") {
            document.getElementById("torneoSeleccionado").classList.remove("d-none");
          }
        });
      });
  
      // Configurar submenús
      toggleSubmenu("notificaciones", "submenuNotificaciones"); // Submenú de Notificaciones
      toggleSubmenu("datomedico", "submenuDatosMedicos"); // Submenú de Datos Médicos
      toggleSubmenu("estudios", "submenuEstudios"); // Submenú de Estudios
  
      // Lógica para alternar el menú hamburguesa en pantallas pequeñas
      const toggler = document.querySelector(".navbar-toggler");
      const menuItems = document.getElementById("menuItems");
  
      if (toggler && menuItems) {
        toggler.addEventListener("click", function () {
          // Alternar la clase "show" en el menú
          if (menuItems.classList.contains("show")) {
            menuItems.classList.remove("show");
          } else {
            menuItems.classList.add("show");
          }
        });
  
        // Cerrar el menú si se hace clic fuera de él
        document.addEventListener("click", function (event) {
          if (!menuItems.contains(event.target) && !toggler.contains(event.target)) {
            menuItems.classList.remove("show");
          }
        });
      }
    }
  
    // Ejecutar la inicialización al cargar la página
    initializeMenu();
  });
  
</script>


{% endblock %}


